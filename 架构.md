# 网页版《Supertype》项目全方案
适配大二水平，基于**物理字母块+解谜+场景交互**核心玩法，支持 GitHub Pages 部署与后期联机 demo，技术选型轻量化、文档完善，分工清晰可落地。（仅供参考）

## 一、核心技术栈（贴合《Supertype》物理字母玩法）
Philipp Stollenmayer 版《Supertype》的核心是 **字母块物理交互+解迷+场景机关**，技术栈优先适配物理引擎、拖拽交互、轻量化部署需求：

| 模块                | 技术选型                                                                 | 选型理由（适配大二+《Supertype》核心玩法）|
|---------------------|--------------------------------------------------------------------------|------------------------------------------------------------------------------------------|
| 2D 物理字母核心     | **Phaser 3 + 内置 Matter.js 物理引擎**                                   | 核心实现字母块的**碰撞、堆叠、弹性形变（？）**（Matter.js 原生支持刚体属性、拖拽交互）；Phaser 封装场景管理，教程丰富，无需自研物理逻辑 |
| 前端 UI/交互        | HTML5 + CSS3 + Tailwind CSS + Vanilla JS                                | 快速实现极简风格 UI（贴合原版简约设计）；Vanilla JS 直控字母拖拽事件，避免复杂框架；Tailwind 适配移动端触摸交互 |
| 数据存储（GitHub）  | GitHub Gist API + GitHub Personal Access Token (PAT)                     | 轻量存储用户**创意单词存档、解锁皮肤、关卡进度**，无需自建数据库；与 GitHub 生态兼容，符合“数据存 GitHub”需求 |
| 部署                | GitHub Pages                                                             | 免费静态部署，直接托管前端代码，支持 PC/移动端访问，完美适配“网页游玩”需求 |
| 后期多人联机        | Node.js + Socket.io + Vercel/Render（免费后端）| Socket.io 低延迟同步字母块位置/状态，实现双人协作拼词；Vercel 免费部署 Node.js 服务，适配大二后端学习成本 |
| 构建/打包           | Vite                                                                     | 比 Webpack 简单，支持热更新、快速打包；适配前端项目开发节奏，解决资源路径问题 |

## 二、项目架构（分层设计+3人分工，贴合《Supertype》逻辑）
整体采用 **物理字母层 + 数据交互层 + UI 层**，3人分工无重叠，可独立开发后整合，核心还原原版“字母物理交互+创意拼词”的核心体验：

### 1. 整体架构流程图
```
用户访问 → GitHub Pages → 前端页面
├─ 物理字母层（Phaser+Matter.js）：字母块创建、碰撞、弹性形变、场景机关
├─ 数据交互层：GitHub Gist API 调用、PAT 验证、用户数据读写/本地缓存
└─ UI 层：登录界面、字母选择、拼词展示、关卡选择、结算页面（Tailwind CSS）
```

### 2. 3人分工（责任明确，适配大二能力）
| 角色       | 负责模块                | 核心工作内容（贴合《Supertype》玩法）|
|------------|-------------------------|------------------------------------------------------------------------------|
| 同学A（游戏核心） | 物理字母       | 1. 用 Phaser 创建字母刚体（自定义质量/摩擦力/弹性，还原原版手感）；<br>2. 设计场景机关（如字母块触发的门、传送带，适配关卡） |
| 同学B（数据+登录） | 数据存储+登录认证       | 1. 封装 GitHub Gist API 函数（创建/读取/更新用户存档）；<br>2. 实现 PAT 验证逻辑（权限检查、错误处理、本地缓存）（假装写了就行）；<br>3. 设计用户数据结构（解锁字母皮肤/？、关卡进度）；<br>4. 开发极简登录界面（GitHub ID/PAT 输入，贴合原版简约风格） |
| 同学C（UI+部署+联机预研） | UI+部署+联机基础        | 1. 开发极简 UI（字母选择面板、拼词展示区、关卡选择页，Tailwind 实现原版简约风）；<br>2. 配置 GitHub Pages 部署流程（Vite 打包、gh-pages 插件）；<br>3. 兼容性测试（多浏览器/移动端触摸适配）；<br>4. 预研 Socket.io 联机基础（房间创建、字母块状态同步） |

### 3. 核心数据结构（JSON，存于 GitHub Gist）
贴合《Supertype》的**创意单词存档+个性化设置**需求，存档文件命名为 `supertype-save.json`：
```json
{
  "userId": "GitHub用户名",
  "gameData": {
    "unlockedLevels": [1,2,3], // 解锁关卡（场景机关复杂度递增）
    "currentLevel": 3, // 当前关卡
    "creativeWords": [ // 用户创意拼词存档（核心数据）
      { "word": "CAT", "score": 150, "scene": "level3", "time": "2026-02-01" },
      { "word": "ACT", "score": 180, "scene": "level3", "time": "2026-02-01" }
    ],
    "unlockedSkins": ["default", "wood", "metal"], // 解锁字母皮肤
    "settings": { // 游戏设置（贴合原版极简风格）
      "elasticity": 0.6, // 字母弹性
      "friction": 0.3, // 字母摩擦力
      "sound": true,
      "volume": 0.5
    }
  }
}
```

## 三、项目进度规划（8周，适配大二课余时间）
按“预研→核心开发→测试→部署→联机预研”分阶段，每周 5-8 小时，里程碑明确，优先实现**单人核心玩法**，再扩展联机 demo：

| 阶段       | 时间（周） | 核心目标（贴合《Supertype》开发优先级） | 各角色具体任务                                                                 | 里程碑输出                          |
|------------|------------|-----------------------------------|------------------------------------------------------------------------------|-----------------------------------|
| 需求&技术预研 | 第1周      | 拆解原版玩法+物理参数+UI 原型     | A：分析原版字母物理参数（弹性/摩擦力）、整理 5000+ 英文单词库、设计3个关卡场景；<br>B：学习 GitHub Gist API/PAT 生成、编写 API 调用 demo；<br>C：用 Figma 画极简 UI 原型（字母面板/拼词区）、学习 GitHub Pages 部署 | 1. 物理参数文档；2. API 调用 demo；3. UI 原型图；4. 单词库文件 |
| 核心开发1（物理字母基础） | 第2-3周    | 实现字母块物理交互+基础拼词       | A：搭建 Phaser 场景、创建字母刚体、实现拖拽交互、完成基础拼词判定；<br>B：封装 API 读取函数、测试 PAT 验证；<br>C：开发登录页骨架、适配移动端触摸 | 1. 可拖拽的字母物理 demo；2. 基础拼词功能；3. API 读取 demo |
| 核心开发2（关卡+数据存储） | 第4-5周    | 实现3个核心关卡+数据存档          | A：完成3个关卡（场景机关+通关条件）、优化字母物理手感、创意拼词计分；<br>B：实现数据写入/更新 Gist、本地缓存（减少 API 请求）；<br>C：完善关卡选择/拼词展示 UI、对接登录逻辑 | 1. 3个可玩关卡；2. 登录存档创意单词功能；3. 极简风格 UI |
| 测试&修复  | 第6周      | 修复物理 BUG+兼容性测试           | A：修复物理 BUG（字母穿透、拖拽卡顿）、优化拼词判定容错；<br>B：处理 API 异常（网络错误、PAT 失效）；<br>C：测试多浏览器/移动端（触摸适配、屏幕适配） | 1. BUG 修复清单；2. 兼容性测试报告 |
| 部署&优化  | 第7周      | 部署 GitHub Pages+体验优化        | A：优化字母物理性能（减少刚体数量、开启睡眠模式）；<br>B：增加创意单词备份功能；<br>C：配置 Vite 打包、部署到 GitHub Pages、编写使用文档 | 1. 可访问的 GitHub Pages 游戏链接；2. 优化后的游戏体验 |
| 联机预研&收尾 | 第8周      | 联机 demo 验证+项目收尾           | A：适配联机字母状态同步逻辑；<br>B：设计联机数据传输格式（字母位置/状态）；<br>C：实现 Socket.io 房间创建/状态同步 demo、部署后端 | 1. 双人联机拼词 demo；2. 完整源码+技术文档 |

## 四、关键技术实现细节（避坑+核心代码）
### 1. 核心：字母块物理交互（Phaser+Matter.js）
还原《Supertype》的**字母拖拽+物理碰撞**手感，是游戏的核心：
```javascript
// Phaser 游戏配置
const config = {
  type: Phaser.AUTO,
  width: 800,
  height: 600,
  parent: 'game-container',
  physics: {
    default: 'matter',
    matter: {
      gravity: { y: 0.5 }, // 轻微重力，让字母有下落感
      debug: false, // 调试模式，发布时关闭
      bodyDebug: false
    }
  },
  scene: {
    preload: preload,
    create: create,
    update: update
  }
};

const game = new Phaser.Game(config);
let letters = []; // 存储字母块
const wordBank = ["CAT", "DOG", "ACT", "BALL"]; // 单词库

// 预加载字母纹理（极简风格，可替换为皮肤）
function preload() {
  this.load.image('letter', 'assets/letter.png');
}

function create() {
  // 创建字母块（以 A/B/C 为例）
  const letterChars = ['C', 'A', 'T'];
  letterChars.forEach((char, index) => {
    const letter = this.matter.add.image(
      100 + index * 80, // x 坐标
      100, // y 坐标
      'letter',
      null,
      {
        mass: 1, // 质量
        friction: 0.3, // 摩擦力
        restitution: 0.6, // 弹性，影响碰撞反弹
        label: `letter-${char}` // 标记字母，用于拼词判定
      }
    );
    // 开启拖拽
    letter.setInteractive();
    this.input.setDraggable(letter);
    // 添加字母文本
    const text = this.add.text(0, 0, char, { fontSize: '32px', fill: '#000' });
    Phaser.Display.Align.In.Center(text, letter);
    letter.text = text;
    letters.push(letter);
  });

  // 拖拽事件
  this.input.on('drag', (pointer, gameObject, dragX, dragY) => {
    gameObject.setPosition(dragX, dragY);
    gameObject.text.setPosition(dragX, dragY);
  });

  // 拼词判定（每帧检测字母排列）
  this.time.addEvent({
    delay: 500,
    loop: true,
    callback: () => checkWord(letters)
  });
}

// 拼词判定核心函数
function checkWord(letters) {
  // 按 x 坐标排序字母（从左到右）
  const sortedLetters = [...letters].sort((a, b) => a.x - b.x);
  const currentWord = sortedLetters.map(l => l.label.split('-')[1]).join('');
  // 校验单词库
  if (wordBank.includes(currentWord)) {
    alert(`创意拼词成功：${currentWord}!`);
    // 触发通关逻辑/加分
  }
}

function update() {
  // 实时更新字母文本位置
  letters.forEach(letter => {
    letter.text.setPosition(letter.x, letter.y);
  });
}
```

### 2. GitHub Gist 数据存储（创意单词存档）
```javascript
// 读取用户创意单词存档
async function getUserSaveData(userId, pat) {
  try {
    const res = await fetch(`https://api.github.com/users/${userId}/gists`, {
      headers: {
        'Authorization': `token ${pat}`,
        'Accept': 'application/vnd.github.v3+json'
      }
    });
    if (!res.ok) throw new Error(`API 错误：${res.status}`);
    const gists = await res.json();
    const gameGist = gists.find(g => g.description === 'supertype-creative-words');
    if (gameGist) {
      const saveContent = gameGist.files['supertype-save.json'].content;
      return JSON.parse(saveContent);
    }
    return null;
  } catch (err) {
    alert('读取存档失败：' + err.message);
    return null;
  }
}

// 保存创意单词
async function saveCreativeWord(userId, pat, word, score, scene) {
  const saveData = await getUserSaveData(userId, pat);
  const newWord = { word, score, scene, time: new Date().toLocaleDateString() };
  
  // 新存档/更新存档
  const gameData = saveData ? saveData.gameData : {
    unlockedLevels: [1], currentLevel: 1, creativeWords: [], unlockedSkins: ["default"], settings: {}
  };
  gameData.creativeWords.push(newWord);

  const url = saveData ? `https://api.github.com/gists/${saveData.id}` : 'https://api.github.com/gists';
  const method = saveData ? 'PATCH' : 'POST';

  try {
    await fetch(url, {
      method,
      headers: {
        'Authorization': `token ${pat}`,
        'Accept': 'application/vnd.github.v3+json',
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({
        description: 'supertype-creative-words',
        files: {
          'supertype-save.json': { content: JSON.stringify({ userId, gameData }) }
        }
      })
    });
    alert(`创意单词 ${word} 存档成功！`);
  } catch (err) {
    alert('存档失败：' + err.message);
  }
}
```

### 2. GitHub Pages 部署步骤
1. **配置 Vite**：修改 `vite.config.js` 解决资源路径问题
    ```javascript
    import { defineConfig } from 'vite';
    export default defineConfig({
      base: '/supertype-web/', // 替换为你的 GitHub 仓库名
      build: { outDir: 'dist' }
    });
    ```
2. **安装部署依赖**
    ```bash
    npm install gh-pages --save-dev
    ```
3. **配置 package.json 脚本**
    ```json
    "scripts": {
      "dev": "vite",
      "build": "vite build",
      "deploy": "gh-pages -d dist"
    }
    ```
4. **执行部署**
    ```bash
    npm run build && npm run deploy
    ```
5. **访问地址**：`https://你的GitHub用户名.github.io/supertype-web/`

### 3. 联机 demo：双人字母状态同步（Socket.io）
#### （1）后端（Node.js，部署到 Vercel）
```javascript
const express = require('express');
const http = require('http');
const { Server } = require('socket.io');
const cors = require('cors');

const app = express();
app.use(cors());
const server = http.createServer(app);

// 配置 CORS，允许 GitHub Pages 访问
const io = new Server(server, {
  cors: { origin: "https://你的GitHub用户名.github.io" }
});

// 房间存储：{ roomId: { letters: [] } }
const rooms = {};

io.on('connection', (socket) => {
  // 创建房间
  socket.on('createRoom', (roomId) => {
    rooms[roomId] = { letters: [] };
    socket.join(roomId);
  });

  // 加入房间
  socket.on('joinRoom', (roomId) => {
    if (!rooms[roomId]) return socket.emit('roomNotFound');
    socket.join(roomId);
    // 同步已有字母状态
    socket.emit('syncLetters', rooms[roomId].letters);
  });

  // 同步字母位置/状态
  socket.on('updateLetter', (data) => {
    const { roomId, letterId, x, y, angle } = data;
    if (!rooms[roomId]) return;
    // 更新房间字母状态
    const letterIndex = rooms[roomId].letters.findIndex(l => l.id === letterId);
    if (letterIndex > -1) {
      rooms[roomId].letters[letterIndex] = { id: letterId, x, y, angle };
    } else {
      rooms[roomId].letters.push({ id: letterId, x, y, angle });
    }
    // 广播给房间内其他玩家
    socket.to(roomId).emit('letterUpdated', data);
  });
});

const PORT = process.env.PORT || 3000;
server.listen(PORT, () => console.log(`服务启动：${PORT}`));
module.exports = app; // 适配 Vercel 部署
```

#### （2）前端同步逻辑
```javascript
// 连接后端
const socket = io('https://你的Vercel后端地址');
let currentRoomId = 'room123';

// 创建房间
function createRoom() {
  socket.emit('createRoom', currentRoomId);
}

// 加入房间
function joinRoom() {
  socket.emit('joinRoom', currentRoomId);
  // 接收已有字母状态
  socket.on('syncLetters', (letters) => {
    // 更新本地字母位置
    letters.forEach(letterData => {
      const letter = letters.find(l => l.id === letterData.id);
      if (letter) {
        letter.setPosition(letterData.x, letterData.y);
        letter.setAngle(letterData.angle);
      }
    });
  });
}

// 字母拖拽时同步状态
function onLetterDrag(letter) {
  socket.emit('updateLetter', {
    roomId: currentRoomId,
    letterId: letter.id,
    x: letter.x,
    y: letter.y,
    angle: letter.angle
  });
}

// 接收其他玩家字母更新
socket.on('letterUpdated', (data) => {
  const letter = letters.find(l => l.id === data.letterId);
  if (letter) {
    letter.setPosition(data.x, data.y);
    letter.setAngle(data.angle);
  }
});
```

## 五、避坑指南（针对大二学生+《Supertype》网页版）
1. **字母物理手感优化**：调整 `mass`/`friction`/`restitution` 参数，参考原版手感（弹性 0.5-0.7，摩擦力 0.2-0.4）；开启 Matter.js 睡眠模式（静止字母不计算物理），提升性能。
2. **GitHub PAT 权限**：仅勾选 `gist` 权限，避免用户泄露高权限 Token；PAT 只存在本地 `localStorage`，不传输到任何服务器。
3. **移动端触摸适配**：Phaser 拖拽事件需兼容触摸，避免 PC 鼠标事件在移动端失效；调整字母大小，适配小屏设备。
4. **API 频率限制**：GitHub API 未认证 60 次/小时，认证后 5000 次/小时；创意单词仅在通关后存档，减少 API 请求。
5. **联机状态同步**：只同步字母核心状态（ID/位置/角度），避免传输大量数据；控制同步频率（50ms/次），减少卡顿。

## 六、最终交付物
1. GitHub 仓库（含完整源码、README、技术文档）；
2. GitHub Pages 可访问的游戏链接（单人模式+创意单词存档）；
3. 双人联机拼词 demo（Vercel 后端+状态同步）；
4. 测试报告（BUG 修复清单、兼容性测试）；
5. 使用文档（游戏规则、联机教程）。

## 总结
本方案完全贴合 Philipp Stollenmayer 版《Supertype》的**物理字母+创意拼词**核心玩法，技术选型适配大二学生水平，8周周期贴合课余时间，分工清晰可落地，同时支持 GitHub Pages 部署与后期联机扩展。

---

我可以帮你整理**单词库文件**，包含5000+常用英文单词并按难度分级，方便直接导入游戏使用，需要吗？